scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=0,b=-30)))  +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=20,b=-20)))  +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=30,b=-20)))  +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=30,b=-30)))  +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))  +
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
full <- lm(formula = Final.exam.Invoked ~ Unit.exam.Invoked + Rework, data=dat)
out  = as.data.frame(predict(full,interval = "confidence"))
out$Rework = factor(dat$Rework)
out$Unit.exam.Invoked = dat$Unit.exam.Invoked
out = out %>% arrange(Unit.exam.Invoked)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=20,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=20,b=-20))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=20,b=-22))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.87, 0.15),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
full <- lm(formula = Final.exam.Invoked ~ Unit.exam.Invoked + Rework, data=dat)
out  = as.data.frame(predict(full,interval = "confidence"))
out$Rework = factor(dat$Rework)
out$Unit.exam.Invoked = dat$Unit.exam.Invoked
out = out %>% arrange(Unit.exam.Invoked)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.1),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.06),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.07),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
out$Unit.exam.Invoked = dat$Unit.exam.Invoked
out = out %>% arrange(Unit.exam.Invoked)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.1),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.1),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
full <- lm(formula = Final.exam.Invoked ~ Unit.exam.Invoked + Rework, data=dat)
out  = as.data.frame(predict(full,interval = "confidence"))
out$Rework = factor(dat$Rework)
out$Unit.exam.Invoked = dat$Unit.exam.Invoked
out = out %>% arrange(Unit.exam.Invoked)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=25,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("Invoked - All Problems") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
full <- lm(formula = Final.exam.Apply ~ Unit.exam.Apply + Rework, data=dat)
partial <- lm(formula = Final.exam.Apply ~ Unit.exam.Apply, data=dat)
out  = as.data.frame(predict(full,interval = "confidence"))
out$partial = predict(partial)
out$Rework = factor(dat$Rework)
out$Unit.exam.Apply = dat$Unit.exam.Apply
out = out %>% arrange(Unit.exam.Apply)
ggplot(dat,aes(x = Unit.exam.Apply,y = Final.exam.Apply,group = Rework,col = Rework)) +
geom_point() +
geom_smooth(method = "lm")
ggplot(dat,aes(x = Unit.exam.Apply,y = Final.exam.Apply,group = Rework,col = Rework)) +
geom_point() +
geom_smooth(method = "lm") +
# geom_ribbon(data = out,aes(ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=partial),size = 1,col = "green")+
ggtitle("All - Applied") +
theme(plot.title = element_text(size = 28,hjust = 0.5))  +
xlab("Unit Exam - Apply ") +
ylab("Final Exam - Apply ") +
ggtitle("Apply - All Problems") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25)))  +
scale_color_discrete(name = "Reworked?")
ggplot(dat,aes(x = Unit.exam.Apply,y = Final.exam.Apply,group = Rework,col = Rework)) +
geom_point() +
geom_smooth(method = "lm") +
# geom_ribbon(data = out,aes(ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=partial),size = 1,col = "green")+
ggtitle("All - Applied") +
theme(plot.title = element_text(size = 28,hjust = 0.5))  +
xlab("Unit Exam - Apply ") +
ylab("Final Exam - Apply ") +
ggtitle("Apply - All Problems") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25)))  +
scale_color_discrete(name = "Reworked?")
ggsave("all_apply.pdf",units = "in",width = 8,height = 8)
ggplot(dat,aes(x = Unit.exam.Apply,y = Final.exam.Apply,group = Rework,col = Rework)) +
geom_point() +
geom_smooth(method = "lm") +
# geom_ribbon(data = out,aes(ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=partial),size = 1,col = "green")+
theme(plot.title = element_text(size = 28,hjust = 0.5))  +
xlab("Unit Exam") +
ylab("Final Exam") +
ggtitle("All - Applied") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25)))  +
scale_color_discrete(name = "Reworked?")
ggplot(dat,aes(x = Unit.exam.Apply,y = Final.exam.Apply,group = Rework,col = Rework)) +
geom_point() +
geom_smooth(method = "lm") +
# geom_ribbon(data = out,aes(ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Apply,y=partial),size = 1,col = "green")+
theme(plot.title = element_text(size = 28,hjust = 0.5))  +
xlab("Unit Exam") +
ylab("Final Exam") +
ggtitle("All - Applied") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25)))  +
scale_color_discrete(name = "Reworked?")
ggsave("all_apply.pdf",units = "in",width = 8,height = 8)
full <- lm(formula = Final.exam.Invoked ~ Unit.exam.Invoked + Rework, data=dat)
out  = as.data.frame(predict(full,interval = "confidence"))
out$Rework = factor(dat$Rework)
out$Unit.exam.Invoked = dat$Unit.exam.Invoked
out = out %>% arrange(Unit.exam.Invoked)
ggplot(dat ,aes(x = Unit.exam.Invoked,y = Final.exam.Invoked,group = Rework,col = Rework)) +
geom_point() +
geom_ribbon(data = out,aes(x = Unit.exam.Invoked,ymin=lwr,ymax=upr,group =Rework),fill = "gray",col = "gray",alpha = 0.7)+
geom_line(data = out,aes(x = Unit.exam.Invoked,y=fit,group =Rework,col = Rework),size = 1)+
# geom_line(data = out,aes(x = Unit.exam.Invoked,y=partial),size = 1,col = "green")+
ggtitle("All - Invoked") +
theme(plot.title = element_text(size = 28,hjust = 0.5))+
xlab("Unit Exam Score") +
ylab("Final Exam Score") +
theme(axis.text = element_text(size = 18),
axis.title = element_text(size = 20),
legend.text = element_text(size = 20),
legend.title = element_text(size = 24),
legend.position = c(0.88, 0.08),
plot.title = element_text(size = 28,hjust = 0.5, vjust=0.5, margin=margin(t=40,b=-25))) +
scale_color_discrete(name = "Reworked?") +
scale_x_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2), limits = c(0,1))+
scale_y_continuous(breaks =seq(0,1,by = 0.2), labels = seq(0,1,by = 0.2))
ggsave("all_invoke.pdf",units = "in",width = 8,height = 8)
logit_ex = 3
1/(1 + e^(-logit_ex))
1/(1 + exp(-logit_ex))
1/(1 + exp(-logit_ex)
)
logit_ex = 25
1/(1 + exp(-logit_ex))
7*35
5*40 + 45*2
7*20
ks.test(runif(100))
?ks.test
ks.test(runif(100),"punif")
setwd("C:/Users/philaw/Box/Research/Porcu/network/share_code/traffic")
library(MASS)
library(RcppArmadillo)
library(RcppEigen)
library(Rcpp)
library(geosphere)
library(nimble)
library(fields)
rm(list = ls())
source("models.R")
constants <- list(n = n,
dists = dist_mat, time = time_mat, n_cov = n_cov,
cov_pars_mean = c(0,0,0),
cov_pars_cov = diag(c(10,10,10)),
zeros = rep(0,n))
data <- list(y = dat$counts)
attach(data)
attach(constants)
inits <- list(beta = coef(glm_mod),
log_cov_pars = log(c(1,10,5)),
w = res.w,
r = 20,
zero_prob = 1/2)
model <- nimbleModel(gc_ZIP,
constants = constants,
data = data,
inits = inits)
mcmcConf <- configureMCMC(model)
mcmcConf$removeSamplers(c('w',"log_cov_pars"))
mcmcConf$addSampler(target = c("log_cov_pars[1]"), type = 'RW')
mcmcConf$addSampler(target = c("log_cov_pars[2]"), type = 'RW')
mcmcConf$addSampler(target = c("log_cov_pars[3]"), type = 'RW')
mcmcConf$addSampler(target = c("w"), type = 'ess')
mcmcConf$addMonitors(c('beta',"log_cov_pars","w","zero_prob"))
mcmcConf$enableWAIC = TRUE
mcmcConf
codeMCMC <- buildMCMC(mcmcConf)
Cmodel = compileNimble(codeMCMC,model)
n_tot = 200
n_burn = 100
n_post = n_tot - n_burn
n_thin = 20
post_samples <- runMCMC(Cmodel$codeMCMC,niter = n_tot,nburnin = n_burn,
thin = n_thin,WAIC = TRUE)
